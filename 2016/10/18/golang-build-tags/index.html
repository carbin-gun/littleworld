<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>golang build tags &middot; Little World</title>
    <meta name="generator" content="Hugo 0.17-DEV" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="author" content="carbin-gun">
    
      <meta name="description" content="Hello,World!">
    
    
    <link rel="icon" href="http://littleworld.me/favicon.ico">
    <link rel="apple-touch-icon" href="http://littleworld.me/apple-touch-icon.png" />
    <link rel="stylesheet" href="http://littleworld.me/css/style.css">
    <link rel="stylesheet" href="http://littleworld.me/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://littleworld.me/css/monokai.css">
    <link rel="stylesheet" href="http://littleworld.me/fancybox/jquery.fancybox.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
    <meta property="og:title" content="golang build tags" />
<meta property="og:description" content="golang build tags introduction,and some tricks for it.
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://littleworld.me/2016/10/18/golang-build-tags" />


<meta property="og:updated_time" content="2016-10-18T12:00:00&#43;08:00"/>










    
    
<meta itemprop="name" content="golang build tags">
<meta itemprop="description" content="golang build tags introduction,and some tricks for it.
">


<meta itemprop="dateModified" content="2016-10-18T12:00:00&#43;08:00" />
<meta itemprop="wordCount" content="560">



<meta itemprop="keywords" content="cache,golang,programming,distribute,golang,lock,poi,queue,rabbitmq,rate-limit,redis,string,zookeeper," />

    

  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="golang build tags"/>
<meta name="twitter:description" content="golang build tags introduction,and some tricks for it.
"/>
<meta name="twitter:site" content="@cilendeng"/>


    

    
</head>
<body>
<div class="container">


<div id="container">
	<header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="http://littleworld.me/" id="logo">
          
          <i class="logo" style="background-image: url('http://littleworld.me/css/images/logo.png')"></i>
          
          <span class="site-title">Little World</span>
      </a>
      <nav id="main-nav">
          
          
          <a class="main-nav-link" href="http://littleworld.me/">Home</a>
          
          
          
          
          
          

          

          
          
          
          
          <a class="main-nav-link" href="http://littleworld.me/tags/">Tags</a>
          
          
          
          <a class="main-nav-link" href="http://littleworld.me/categories/">Categories</a>
          
          
      </nav>
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="http://littleworld.me/css/images/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
              <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
              <button type="submit" class="search-form-submit">
              </button>
              <input type="hidden" name="q" value="site:http://littleworld.me/">
         </form>
        </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tbody>
          <tr>
          
          
          <td><a class="main-nav-link" href="http://littleworld.me/">Home</a></td>
          
          
          
          
          
          

          

          
          
          
          
          <td><a class="main-nav-link" href="http://littleworld.me/tags/">Tags</a></td>
          
          
          
          <td><a class="main-nav-link" href="http://littleworld.me/categories/">Categories</a></td>
          
          
          <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form">
          <input type="search" name="q" results="0" class="search-form-input" placeholder="Search">
          <input type="hidden" name="q" value="site:http://littleworld.me/">
          </form>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</header>

   	
   	<div class="outer">
   		
	    <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="http://littleworld.me/css/images/avatar.png">
      <h2 id="name">carbin-gun</h2>
      <h3 id="title">Programmer - Gopher - Blogger</h3>
      <span id="location"><i class="fa fa-map-marker"></i>Beijing</span>
      
          <a id="follow" href="https://github.com/carbin-gun">
              Follow
          </a>
      
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        6
        <span>Posts</span>
      </div>
      <div class="article-info-block">
        
          10
        
        <span>
            Tags
        </span>
      </div>
    </div>
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
<td><a href="//github.com/carbin-gun" target="_blank" title="GitHub"><i class="fa fa-github"></i></a></td>




















































<td><a href="//twitter.com/cilendeng" target="_blank" title="Twitter"><i class="fa fa-twitter"></i></a></td>


          <td><a href="" target="_blank" title="RSS"><i class="fa fa-rss"></i></a></td>
        </tr>
      </table>
    </div>
  </div>
</aside>

	    

	    
<section id="main">

    <article id="page-undefined" class="article article-type-page" itemscope="" itemprop="blogPost">
        <div class="article-inner">
            
                <img src="http://littleworld.me/banners/go.jpeg" class="article-banner">
            

            <header class="article-header">
    <a href="http://littleworld.me/2016/10/18/golang-build-tags">
    <h1 class="article-title" itemprop="name">
        golang build tags
    </h1>
    </a>
    <div class="article-meta">
        <div class="article-date">
            <i class="fa fa-calendar"></i>
            <time datetime="2016-10-18 12:00:00 &#43;0800 CST" itemprop="datePublished">2016-10-18</time>
            &middot;
            560
            words
            &middot;
            3
            minute read
        </div>

        
        
            
            
            <div class="article-category">
                <i class="fa fa-folder"></i>
                
                <a class="article-category-link" href="http://littleworld.me/categories/programming">programming</a>
                &middot;
                
                <a class="article-category-link" href="http://littleworld.me/categories/golang">golang</a>
                
                
            </div>
            
        

        
            
            
            <div class="article-category">
                <i class="fa fa-tags"></i>
                
                <a class="article-category-link" href="http://littleworld.me/tags/golang">golang</a>
                
                
            </div>
            
        
    </div>
</header>

            <div class="article-entry" itemprop="articleBody">
                

<p>golang build tags introduction,and some tricks for it.</p>

<h1 id="golang-build-tags">golang build tags</h1>

<h2 id="introduction">Introduction</h2>

<ul>
<li><p>A build constraint, also known as a build tag, is a line comment that begins</p>

<pre><code>// +build
</code></pre>

<p><strong>that lists the conditions under which a file should be included in the package</strong>. Constraints may appear in any kind of source file (not just Go), but they must appear near the top of the file, preceded only by blank lines and other line comments. These rules mean that in Go files a build constraint must appear before the package clause.</p></li>

<li><p>To distinguish build constraints from package documentation, a series of build constraints must be followed by a blank line.</p></li>

<li><p>A build constraint is evaluated as the OR of space-separated options; each option evaluates as the AND of its comma-separated terms; and each term is an alphanumeric word or, preceded by !, its negation. That is, the build constraint:</p>

<pre><code>// +build linux,386 darwin,!cgo

</code></pre>

<p>corresponds to the boolean formula:</p>

<pre><code>// +build (linux AND 386) OR (darwin AND (NOT cgo))
</code></pre></li>

<li><p>A file may have multiple build constraints. The overall constraint is the AND of the individual constraints. That is, the build constraints:</p>

<pre><code>// +build linux darwin
// +build 386
</code></pre>

<p>corresponds to the boolean formula:</p>

<pre><code>// +build (linux OR darwin) AND 386
</code></pre></li>

<li><p>If a file&rsquo;s name, after stripping the extension and a possible _test suffix, matches any of the following patterns:</p>

<pre><code class="language-go">*_GOOS
*_GOARCH
*_GOOS_GOARCH
</code></pre>

<p>(example: source_windows_amd64.go) where <strong>GOOS and GOARCH represent any known operating system and architecture values respectively, then the file is considered to have an implicit build constraint requiring those terms (in addition to any explicit constraints in the file)</strong>.</p></li>

<li><p>To keep a file from being considered for the build:</p>

<pre><code>// +build ignore
</code></pre>

<p>(any other unsatisfied word will work as well, but “ignore” is conventional.)</p></li>
</ul>

<h2 id="common-usage">Common Usage</h2>

<ul>
<li><p>build the source for different platform.all the platforms defined by the <code>GOOS</code> and <code>GOARCH</code>are included by the <code>src/go/build/syslist.go</code>:</p>

<pre><code class="language-golang">package build

const goosList = &quot;android darwin dragonfly freebsd linux nacl netbsd openbsd plan9 solaris windows &quot;
const goarchList = &quot;386 amd64 amd64p32 arm armbe arm64 arm64be ppc64 ppc64le mips mipsle mips64 mips64le mips64p32 mips64p32le ppc s390 s390x sparc sparc64 &quot;
</code></pre></li>
</ul>

<h2 id="tricks">Tricks</h2>

<ul>
<li>prodivde different implementation for different environment,but the environment may not be the <code>GOOS</code> or <code>GOARCH</code>.</li>
<li><code>appengine</code> the build tag has been used by many lib.it&rsquo;s neither <code>GOOS</code> or <code>GOARCH</code>.it&rsquo;s self-defined.</li>
<li>we can define the build tag to build different binary software according to our self-defined build tags.like the appengine do .but we can not use the implicit way( <code>GOOS</code> or <code>GOARCH</code> included in the file name),it will not be recognized by the go compiler.</li>
<li>we can use the explicit build tag comment.</li>
<li>like this example:</li>
</ul>

<p>main.go</p>

<pre><code class="language-go">package main
	
import (
	&quot;fanfu-golang/buildtags/lib&quot;
)
func main(){
	lib.Tell()
}

</code></pre>

<p>lib/dev.go</p>

<pre><code class="language-go">// +build !prod
	
package lib
	
import &quot;fmt&quot;
	
func Tell(){
	fmt.Println(&quot;hello from dev&quot;)
}

</code></pre>

<p>lib/prod.go</p>

<pre><code class="language-golang">// +build prod
	
package lib
	
import &quot;fmt&quot;
	
func Tell(){
	fmt.Println(&quot;hello from dev&quot;)
}

</code></pre>

<p>we can build with <code>go build</code> and execute.it will output.</p>

<pre><code class="language-bash">$ go build
$ ./buildtags
hello from dev

</code></pre>

<p>but when we build with <code>go build --tags prod</code> and execute the binary,the output will be:</p>

<pre><code class="language-bash">$ go build --tags prod
$ ./buildtags
hello from prod

</code></pre>

<p>As to the above example,we use the !prod to match our default env build.Also,we can setup different build tags for different environment,and specify the build tags with every build without default to make it more explicit.</p>

<h2 id="eof">EOF</h2>

            </div>
            <footer class="article-footer">
    <a data-url="http://littleworld.me/2016/10/18/golang-build-tags" data-id="51fc3169593de1d540828c38774a794d" class="article-share-link">
        Share
    </a>
    
    <a href="http://littleworld.me/2016/10/18/golang-build-tags/#disqus_thread" class="article-comment-link">
        Comments
    </a>
    
</footer>

        </div>

        
<nav id="article-nav">
    
    <a href="http://littleworld.me/2016/10/16/redis-lock" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Older
      </strong>
      <div class="article-nav-title">Redis Lock</div>
    </a>
    

    
    <a href="http://littleworld.me/2016/11/24/zookeeper-introduction-with-expiration-explanation" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">
          Newer
      </strong>
      <div class="article-nav-title">zookeeper introduction with expiration explanation</div>
    </a>
    
</nav>


    </article>

    
    <section id="comments">
        <div id="disqus_thread">
            <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'carbingun';
    var disqus_identifier = 'http:\/\/littleworld.me\/2016\/10\/18\/golang-build-tags';
    var disqus_title = 'golang build tags';
    var disqus_url = 'http:\/\/littleworld.me\/2016\/10\/18\/golang-build-tags';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </section>
    
</section>


	    
	    <aside id="sidebar">
    
<div class="widget-wrap">
    <h3 class="widget-title">
        Recents
    </h3>
    <div class="widget">
        <ul id="recent-post">
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://littleworld.me/2016/11/24/zookeeper-introduction-with-expiration-explanation" class="thumbnail">
                    
                        <span style="background-image:url(http://littleworld.me/banners/zk.jpg)" alt="golang build tags" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://littleworld.me/categories/programming">
                        programming
                        </a>
                    </p>
                    
                    
                    <p class="item-title"><a href="http://littleworld.me/2016/11/24/zookeeper-introduction-with-expiration-explanation" class="title">zookeeper introduction with expiration explanation</a></p>
                    <p class="item-date">
                        <time datetime="2016-11-24 14:02:41 &#43;0800 CST" itemprop="datePublished">2016-11-24</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://littleworld.me/2016/10/18/golang-build-tags" class="thumbnail">
                    
                        <span style="background-image:url(http://littleworld.me/banners/go.jpeg)" alt="golang build tags" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://littleworld.me/categories/programming">
                        programming
                        </a>
                    </p>
                    
                    
                    <p class="item-title"><a href="http://littleworld.me/2016/10/18/golang-build-tags" class="title">golang build tags</a></p>
                    <p class="item-date">
                        <time datetime="2016-10-18 12:00:00 &#43;0800 CST" itemprop="datePublished">2016-10-18</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://littleworld.me/2016/10/16/redis-lock" class="thumbnail">
                    
                        <span style="background-image:url(http://littleworld.me/banners/redis.jpg)" alt="golang build tags" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://littleworld.me/categories/programming">
                        programming
                        </a>
                    </p>
                    
                    
                    <p class="item-title"><a href="http://littleworld.me/2016/10/16/redis-lock" class="title">Redis Lock</a></p>
                    <p class="item-date">
                        <time datetime="2016-10-16 14:07:41 &#43;0800 CST" itemprop="datePublished">2016-10-16</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://littleworld.me/2016/10/14/redis-string-operations" class="thumbnail">
                    
                        <span style="background-image:url(http://littleworld.me/banners/redis.jpg)" alt="golang build tags" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://littleworld.me/categories/programming">
                        programming
                        </a>
                    </p>
                    
                    
                    <p class="item-title"><a href="http://littleworld.me/2016/10/14/redis-string-operations" class="title">redis string operations</a></p>
                    <p class="item-date">
                        <time datetime="2016-10-14 16:20:41 &#43;0800 CST" itemprop="datePublished">2016-10-14</time>
                    </p>
                </div>
            </li>
            
            <li>
                <div class="item-thumbnail">
                    <a href="http://littleworld.me/2016/07/31/excel-export-by-poi" class="thumbnail">
                    
                        <span style="background-image:url(http://littleworld.me/banners/writing-desk.png)" alt="golang build tags" class="thumbnail-image"></span>
                    
                    </a>
                </div>
                <div class="item-inner">
                    
                    
                    <p class="item-category">
                        <a class="article-category-link" href="http://littleworld.me/categories/programming">
                        programming
                        </a>
                    </p>
                    
                    
                    <p class="item-title"><a href="http://littleworld.me/2016/07/31/excel-export-by-poi" class="title">excel export by poi</a></p>
                    <p class="item-date">
                        <time datetime="2016-07-31 20:54:41 &#43;0800 CST" itemprop="datePublished">2016-07-31</time>
                    </p>
                </div>
            </li>
            
        </ul>
    </div>
</div>


    


<div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/categories/cache">
                    cache
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/categories/golang">
                    golang
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/categories/programming">
                    programming
                </a>
                <span class="category-list-count">6</span>
            </li>
            
        </ul>
    </div>
</div>



    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tags
    </h3>
    <div class="widget">
        <ul class="category-list">
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/distribute">
                    distribute
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/golang">
                    golang
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/lock">
                    lock
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/poi">
                    poi
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/queue">
                    queue
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/rabbitmq">
                    rabbitmq
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/rate-limit">
                    rate-limit
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/redis">
                    redis
                </a>
                <span class="category-list-count">2</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/string">
                    string
                </a>
                <span class="category-list-count">1</span>
            </li>
            
            <li class="category-list-item">
                <a class="category-list-link" href="http://littleworld.me/tags/zookeeper">
                    zookeeper
                </a>
                <span class="category-list-count">1</span>
            </li>
            
        </ul>
    </div>
</div>



    


<div class="widget-wrap">
    <h3 class="widget-title">
        Tag cloud
    </h3>
    <div class="widget tagcloud">
        
        <a href="http://littleworld.me/tags/distribute" style="font-size: 12px;">distribute</a>
        
        <a href="http://littleworld.me/tags/golang" style="font-size: 12px;">golang</a>
        
        <a href="http://littleworld.me/tags/lock" style="font-size: 12px;">lock</a>
        
        <a href="http://littleworld.me/tags/poi" style="font-size: 12px;">poi</a>
        
        <a href="http://littleworld.me/tags/queue" style="font-size: 12px;">queue</a>
        
        <a href="http://littleworld.me/tags/rabbitmq" style="font-size: 12px;">rabbitmq</a>
        
        <a href="http://littleworld.me/tags/rate-limit" style="font-size: 12px;">rate-limit</a>
        
        <a href="http://littleworld.me/tags/redis" style="font-size: 12px;">redis</a>
        
        <a href="http://littleworld.me/tags/string" style="font-size: 12px;">string</a>
        
        <a href="http://littleworld.me/tags/zookeeper" style="font-size: 12px;">zookeeper</a>
        
    </div>
</div>




    <div id="toTop" class="fa fa-chevron-up"></div>
</aside>

	    
	</div>
</div>

<footer id="footer">
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016
      Powered by <a href="//gohugo.io">Hugo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>.
    </div>
  </div>
</footer>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="http://littleworld.me/fancybox/jquery.fancybox.pack.js"></script>
<script src="http://littleworld.me/js/script.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<!-- MathJax -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>
